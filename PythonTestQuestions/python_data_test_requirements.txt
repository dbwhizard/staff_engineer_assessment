In this directory you will find an excel spreadsheet titled "Privia Family Medicine 113018.xlsx" containing demographics,
quarter and risk data. We need this data to be manipulated and stored in our PersonDatabase for analysis.

Please include solutions to the questions below using python 2.7.
Please include any required modules in a "requirements.txt" file in this directory.
Please provide adequate test coverage for you solutions.

1. Import the 'Demographics' data section to a table in the database. This ETL will need to process files of the
same type delivered later on with different file dates and from different groups.
    a. Include all fields under 'Demographics'
    b. Define the sql schema as necessary. Fields should not include spaces or special characters.
    c. Include fields in the data table that indicate the date of the file and the provider group located in the filename.
        In this case "Privia Family Medicine" 11/30/2018. Assume the length of the group name will change and the date
        will always be formatted at the end of the file as MMDDYY
    d. Include only the first initial of the Middle Name when applicable.
    e. Convert the Sex value to M or F: M for 0 and F for 1


2. Transform and import the 'Quarters' and 'Risk' data into a separate table.
    a. Unpivot the data so that the data table includes
        i. ID
        ii. Quarter
        iii. Attributed flag
        iv. Risk Score
        v. File date
     b. Only include records in which the patients risk has increased.
     
     
     Notes:
     
     In the beginning I planned to use xlrd to get the data from Excel files, but it was too cumbersome to deal with the fields converted
     to float, especially with the date fields, so after wasting a lot of time I ended up with using MS OpenRowset approach. In hindsight, 
     using pandas with dataframes would be probably my Pythonish, but it is too late now.
     
     My scripts required only two modules: os and pyodbc. I created two more source files to fully test both scripts. My assumption is that the source Excel files will be provided in a directory, the name of which is passed as a parameter to the scripts. My testing is done with SQL Server 2014 Express. I am including the SQL script with command that are required to make OpenRowset to work. I also include the CSV files from the resulting Demographics (Q1) and Attribution(Q2) tables.
     
     I wanted to upload the 2 additional spreadsheets that I have created for testing, but the UPLOAD feature doesn't work for me for some reason :(
